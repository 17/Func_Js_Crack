# -*- coding: utf-8 -*-
# @Time    : 2019/10/18 11:04
# @Author  : Esbiya
# @Email   : 18829040039@163.com
# @File    : 58_crypt.py
# @Software: PyCharm


from Crypto.Cipher import AES
from binascii import b2a_hex


def aes_encrypt(key, iv, text):
    """
    AES CBC Pkcs7填充
    :param key: 密钥
    :param iv: 偏移量
    :param text: 明文
    :return:
    """
    bs = AES.block_size
    # pkcs7 填充
    pad = lambda s: s + (bs - len(s) % bs) * chr(bs - len(s) % bs)
    encrypter = AES.new(key.encode(), AES.MODE_CBC, iv.encode())
    cipher_text = encrypter.encrypt(pad(text).encode())
    return b2a_hex(cipher_text).decode()


if __name__ == '__main__':
    text = '{"x":"76","track":"29,16,1|30,16,93|32,17,114|35,18,130|39,18,148|45,19,165|52,20,180|59,20,196|63,20,213|66,20,231|68,20,247|71,20,264|76,20,280|79,20,296|82,20,314|86,20,329|90,21,346|95,21,364|98,21,379|101,21,396|103,21,413|105,21,430|108,21,446|111,21,463|115,21,480|117,21,497|119,21,514|122,21,531|125,21,546|128,21,564|132,21,580|133,22,596|134,22,616|135,22,630|136,22,647|137,22,663|140,22,679|142,22,696|144,22,713|146,22,729|147,22,746|149,22,763|151,22,779|152,22,796|153,22,828|154,22,850|155,22,863|156,23,879|158,23,896|161,23,913|163,23,929|164,23,947|165,23,964|166,23,980|167,23,1013|168,23,1049|168,24,1067|169,24,1082|170,24,1216|171,24,1371|172,24,1442|173,24,1500|173,25,1513|174,25,1624|175,25,1754|176,25,1796|177,25,2821|177,25,3329|","p":"0,0","finger":"tUGrNESxtIBvCy3gqA4uX1IPaRsVRGeOY2E9NFsWZMYWxDHQtHKCll5ANR7RUCKiin35brBb//eSODvMgkQULA=="}'
    response_id = "93b77d6fe53b4196aec830b898bfaae6"
    x = aes_encrypt(response_id[0:16], response_id[0:16], text).upper()
    print(x)
    print('009B4DCD27961F6BBB20AD3EA46394E3D2AA6B6B0E9FAD272A960D47EFBDF5DC6C2E3BC153CD409F058F0723C62447EF6223B4FCBA3E429E1275AC4E9771CEF8112A3BA7C16CC31B823F2096A0A168FB79EFD24EB802EBEA38A3EC0CE1B2692AA21C6B525DCB02F8FC8E497E72DC234D951D50CDA6809E5622E5854851279635D001B42D005AA3ACD1DC35A37AADF91996E75961AD379F7089BD0BE1C1FB5BD128BC8C786E6A0708777145269BDB7608083BC1D79E37943EB260493C9B6E56D08C84D615E6D9D4FF98E7EC2D7BDD5BD57C2131CC163B0326AB6973C7424478E6CA4DE435A9B8EF95423C0F4EE9035FD82299B21F8009CEEC857F95705E9717F7A6E824A7995EC1952543818983034EDF343E5229CE23943DE0ED0530E8DE7253F2AC7FC5ECF21F6E4EC5C1A647F7B206974594EA17C6961F1C41A2F1CFD39B04F3E14D3337889EA7E5C3FC531243808F3A5D964127FFC8B613C043322E049FEEF9168C653C6DD1175436B671F71FF52A243AF99765034FCA5AE97E7E45910BD3B3432F0A88A8FFF0AF2E176E6E8161424DB17D70105413A53064C79EC854F93F5D187F9F8E8BEC2960783E28E330F44C5825331AF57B0EA874FCE99E448E249F2976D0875D6E5BD653FBF2CE4FF277189B098C6FBC4BFBB228D9E85FC4EAD1AE59D154C7AE1DE6F4B808AB7D88826C088C6C7D11C47A6C624F7FCBF0B19A43ACF4DB6808887D8DEC3C376527B0FD7E9F28A568B5BECDF0BB46B7AF17A194DA119C051B5DC0B57C4582018EF77D7C2C81ADAE63376CBDD3DE6EBB3CE408E2C7CC76E950E99EBA4F62BFAD41EF963144CA699B0ABAEB3903D9D935C14728CF1AA2B5AB8B199CEFAD04FAA320E84A8D2F28AED3D027B5048C256D3923049B6E5C7DDB71B4B4AB90CD860E336EF287CEFF83CB204BB5A1D2BF1BB590852961344F516B90C98E788CF6E511519A123DBC01561BCDC13C5C72E41BD3AA3008DE386CD4915A8CB08297001483B4E838194A60568A068049828B6B73B9652D90D6CAC54FCB4775AB13B19C3C17EEF18E1A1981A9ED4A3F72B266DEEC093C11AEA3980EA74E3952D8BC9ECCB450A70703407F8125B983701E8B9D7E338C1C69BCF07146CEE118A6A7F6903D37C5E78910E455FAAE054868FA2611C328679E7B16101A1DC41B36E0467E4B28C6F6AD3655540C86B86FDD48FE9A566F7FA737A25D95EA3530543763EF92F7B826D49C4A87DC1FAFEF')